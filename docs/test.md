# テストケースを生成してテストを実行

ワーキングディレクトリの直下に `main.py` があり、また `main.py` に実行権限が付与されているとします。テストケースを生成してテストを実行するには、

```bash
$ ./main.py test program_1
```

または

```bash
$ ./main.py test program_1 program_2
```

に続けて以下の引数を指定します。ここで、`program_1` と `program_2` はテストを行いたいプログラム(競技プログラミングの問題の解答)を実行するコマンドです。

1 つのプログラムのみを指定すると、テストによって RE (実行時エラー)や TLE (実行時間制限超過)が検出された場合にそのテストケースを保存します。

2 つのプログラムを指定すると、これに加えて WA (出力内容の食い違い)も検出します。

例えば競技プログラミングの問題の解答に C/C++ を使用していて、テストしたいプログラムを実行するコマンドが `./a.out` である場合には以下のように、

```bash
$ ./main.py test ./a.out
```

解答に Python 3 を使用していて、`python3 opt.py` と `python3 naive.py` の実行結果を比較したい場合には以下のようにします(空白を含むコマンドは引用符で囲んでください)。

```bash
$ ./main.py test "python3 opt.py" "python3 naive.py"
```

以下の引数のうち生成するテストケースの数以外は全て省略することができます。

| 引数 1 (省略形)| 引数 2 |
|---|---|
| `--input` (`-i`) | 入力ファイル名 |
| `--prefix` (`-p`) | 出力ファイル名の接頭辞 |
| `--suffix` (`-s`) | 出力ファイル名の接尾辞 |
| `--cases` (`-c`) | 生成するテストケースの数 |
| `--time-limit` (`-t`) | 最大実行時間 (秒) |
| `--no-progress-bar` (`-n`) ||

## 引数の詳細

実行時間制限とテストケースの数以外の引数は[テストケースの生成](https://github.com/naskya/testcase-generator/blob/main/docs/gen.md)で説明されているものと同一です。

### `--time-limit 最大実行時間`

実行時間制限としてテストの最大実行時間を秒で除算した値を指定すると、テストがその時間で終了しなかった場合に実行を打ち切って TLE (実行時間制限超過)と判定します。例えば以下のようにすると、最大実行時間は 3.5 秒間となります。

```
--time-limit 3.5
```

省略した場合、最大実行時間は 2 秒間となります。

## 例

```bash
$ ./main.py test "python3 suspicious.py" --cases 500 --input fmt.txt --prefix cases/ --suffix .in
```

`fmt.txt` で指定された内容でテストケースを 500 個生成し、`python3 suspicious.py` にそれぞれその入力を与えてテストを行います。

RE, TLE が検知されると `cases/001.in`, `cases/002.in`, …… という名前でテストケースが保存されます。また、`cases/result_001.in`, `cases/result_002.in`, …… という名前で検知された内容についての情報が保存されます。

```bash
$ ./main.py test ./a.out ./naive.out -i vars.txt -n -c 2000
```

プログレスバーを非表示にして、`vars.txt` で指定された内容で 2000 個のテストケースを生成して `./a.out` と `./naive.out` に入力として与えてテストを行います。

WA, RE, TLE が検知されると `0001`, `0002`, …… という名前でテストケースが保存されます。また、`result_0001`, `result_0002`, …… という名前で検知された内容についての情報が保存されます。

`test` コマンドでは生成されたケースのうち、WA (出力内容の食い違い), RE (実行時エラー), TLE (実行時間制限超過)が検出されたもののみが保存されます。そのため、保存されるケースの数は生成したテストケースの数以下となります。
